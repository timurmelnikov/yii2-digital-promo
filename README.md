## Тестовое задание Digital Promo

### Задание
- Поднять yii2.
- Поставить систему доступа на основе ролей.
- Добавить 2 роли: «Админ», «Менеджер».
- Сделать возможность добавления Категорий.
- Сделать возможность добавления Товаров и подвязки их к категориям.
- Администраторы имеют полный доступ (могут добавлять, удалять и редактировать категории и товары). Менеджеры могут только просматривать категории и товары.
- Вывести все категории на сайт. При переходе на категорию отображать все товары, которые подвязаны к данной категории.

### Системные требования
PHP - 7.1 и выше (писал на 7.2.10)
MySQL - 5.7.24
nginx - 1.14 

### Установка

- Клонировать репозиторий:
```
git clone https://github.com/timurmelnikov/yii2-digital-promo.git
```
- Установить пакеты composer:
```
composer install
```
- Настроить WEB-сервер (хост для yii2-digital-promo)
Я использую NGINX, прилагаю конфиг-файл - yii2-digital-promo/my_files/yii2-digital-promo
- Создать БД с именем yii2_digital_promo:
```mysql
CREATE SCHEMA yii2_digital_promo CHARACTER SET utf8 COLLATE utf8_general_ci;
```
- Накатить миграции

```
./yii migrate/up
```

### Решение

#### Поднять yii2.
Yii2 поднял с шаблоном basic

#### Поставить систему доступа на основе ролей.

В качестве компонента авторизации authManager, использовал yii\rbac\DbManager

#### Добавить 2 роли: «Админ», «Менеджер».

Сделал 2 роли «Админ», «Менеджер» (admin, manager). Они поднимаются автоматически, при накатывании миграций.
Также, автоматом, создаются 4 пользователя:
- admin с ролью admin
- manager с ролью manager
- user1 без роли (Админ, может задать ее в панели управления пользователей)
- user2 без роли (Админ, может задать ее в панели управления пользователей)
У всех пользователей пароль - 111
Пароли, хранятся в базе "открытым текстом" без хеширования. Я сделал это намеренно, для облегчения работы с тестовым приложением. Пароль можно посмотреть/изменить прямо в базе. Понимаю, что в продакшене ТАК ДЕЛАТЬ НЕЛЬЗЯ, но это тестовое приложение.
Управление пользователями - http://yii2-digital-promo/user, доступно только Админу

####- Сделать возможность добавления Категорий.

На странице категорий - http://yii2-digital-promo/category, реализовано управление категориями. Если у категории есть товары, то она отображается в виде ссылки на эти товары с указанием их количества. Добавление, изменение и удаление доступно только Админу, просмотр списка Админу и Менеджеру.


#### Сделать возможность добавления Товаров и подвязки их к категориям.

На странице продуктов(товаров) - http://yii2-digital-promo/product реализовано управление продуктами Добавление, изменение и удаление доступно только Админу, просмотр списка Админу и Менеджеру. При добавлении/изменении продукта, выбор категории, происходит при помощи компонента Select2 и AJAX поисковых запросов. То-есть, если список категорий будет большой - он не весь "прилетит" на форму редактирования.


#### Администраторы имеют полный доступ (могут добавлять, удалять и редактировать категории и товары). Менеджеры могут только просматривать категории и товары.

В случае, если нет прав - пользователь будет переброшен на страницу с ошибкой Forbidden (#403)


#### Вывести все категории на сайт. При переходе на категорию отображать все товары, которые подвязаны к данной категории.

На главной странице отображаются товары (Ну... Типа это интернет-магазин), они видны всем, даже не авторизированным пользователям. Здесь, я применил пагинацию + Pjax + использовал свой виджет (https://github.com/timurmelnikov/yii2-loading-overlay), о котором говорил на собеседовании. Сверху, отображаются категории, в которых есть товары. При клике на категорию - происходит отбор товаров только этой категории.